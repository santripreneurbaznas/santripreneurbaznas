import{r as t,j as E,F as A}from"./app-b9aa26ba.js";import{M as S,i as W,u as I,P as b,a as D,b as F,L as H}from"./proxy-ca683946.js";class K extends t.Component{getSnapshotBeforeUpdate(u){const e=this.props.childRef.current;if(e&&u.isPresent&&!this.props.isPresent){const s=e.offsetParent,d=W(s)&&s.offsetWidth||0,n=this.props.sizeRef.current;n.height=e.offsetHeight||0,n.width=e.offsetWidth||0,n.top=e.offsetTop,n.left=e.offsetLeft,n.right=d-n.width-n.left}return null}componentDidUpdate(){}render(){return this.props.children}}function U({children:c,isPresent:u,anchorX:e}){const s=t.useId(),d=t.useRef(null),n=t.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:p}=t.useContext(S);return t.useInsertionEffect(()=>{const{width:g,height:r,top:m,left:i,right:l}=n.current;if(u||!d.current||!g||!r)return;const a=e==="left"?`left: ${i}`:`right: ${l}`;d.current.dataset.motionPopId=s;const f=document.createElement("style");return p&&(f.nonce=p),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${g}px !important;
            height: ${r}px !important;
            ${a}px !important;
            top: ${m}px !important;
          }
        `),()=>{document.head.contains(f)&&document.head.removeChild(f)}},[u]),E(K,{isPresent:u,childRef:d,sizeRef:n,children:t.cloneElement(c,{ref:d})})}const X=({children:c,initial:u,isPresent:e,onExitComplete:s,custom:d,presenceAffectsLayout:n,mode:p,anchorX:g})=>{const r=I(B),m=t.useId();let i=!0,l=t.useMemo(()=>(i=!1,{id:m,initial:u,isPresent:e,custom:d,onExitComplete:a=>{r.set(a,!0);for(const f of r.values())if(!f)return;s&&s()},register:a=>(r.set(a,!1),()=>r.delete(a))}),[e,r,s]);return n&&i&&(l={...l}),t.useMemo(()=>{r.forEach((a,f)=>r.set(f,!1))},[e]),t.useEffect(()=>{!e&&!r.size&&s&&s()},[e]),p==="popLayout"&&(c=E(U,{isPresent:e,anchorX:g,children:c})),E(b.Provider,{value:l,children:c})};function B(){return new Map}const P=c=>c.key||"";function z(c){const u=[];return t.Children.forEach(c,e=>{t.isValidElement(e)&&u.push(e)}),u}const V=({children:c,custom:u,initial:e=!0,onExitComplete:s,presenceAffectsLayout:d=!0,mode:n="sync",propagate:p=!1,anchorX:g="left"})=>{const[r,m]=D(p),i=t.useMemo(()=>z(c),[c]),l=p&&!r?[]:i.map(P),a=t.useRef(!0),f=t.useRef(i),x=I(()=>new Map),[k,v]=t.useState(i),[C,L]=t.useState(i);F(()=>{a.current=!1,f.current=i;for(let h=0;h<C.length;h++){const o=P(C[h]);l.includes(o)?x.delete(o):x.get(o)!==!0&&x.set(o,!1)}},[C,l.length,l.join("-")]);const M=[];if(i!==k){let h=[...i];for(let o=0;o<C.length;o++){const y=C[o],w=P(y);l.includes(w)||(h.splice(o,0,y),M.push(y))}return n==="wait"&&M.length&&(h=M),L(z(h)),v(i),null}const{forceRender:R}=t.useContext(H);return E(A,{children:C.map(h=>{const o=P(h),y=p&&!r?!1:i===C||l.includes(o),w=()=>{if(x.has(o))x.set(o,!0);else return;let $=!0;x.forEach(j=>{j||($=!1)}),$&&(R==null||R(),L(f.current),p&&(m==null||m()),s&&s())};return E(X,{isPresent:y,initial:!a.current||e?void 0:!1,custom:u,presenceAffectsLayout:d,mode:n,onExitComplete:y?void 0:w,anchorX:g,children:h},o)})})};export{V as A};
