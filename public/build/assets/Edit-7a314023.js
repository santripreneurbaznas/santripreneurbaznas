import{r as p,G as I,a as r,j as e,S as j,x as G,F as W,A as J,c as g}from"./app-fb5242e2.js";import{A as O}from"./AuthenticatedLayout-a5c10809.js";import{d as k}from"./debounce-60321a07.js";import{t as f}from"./index-6c8c9424.js";import"./Toater-8cbd2bad.js";import"./index-b15d8be6.js";function Z({registration:s,auth:T,categories:F,errors:i}){const[A,P]=p.useState([]),[$,R]=p.useState([]),[L,y]=p.useState([]),[S,b]=p.useState([]),[o,d]=p.useState({provinces:!1,regencies:!1,districts:!1,villages:!1}),[m,u]=p.useState({provinces:null,regencies:null,districts:null,villages:null}),{data:n,setData:c,post:V,processing:_,reset:D,progress:v}=I({category_id:s.category_id||"",place_of_birth:s.place_of_birth||"",date_of_birth:s.date_of_birth||"",gender:s.gender||"",address:s.address||"",province:s.province||"",kabupaten:s.kabupaten||"",kecamatan:s.kecamatan||"",kelurahan:s.kelurahan||"",boarding_school_name:s.boarding_school_name||"",motivation:s.motivation||"",estimated_monthly_income:s.estimated_monthly_income||"",number_wa:s.number_wa||"",business_proposal_file:null,mustahik_certificate_file:null,pesantren_certificate_file:null}),M=a=>{a.preventDefault();const t=new FormData;t.append("category_id",n.category_id),t.append("place_of_birth",n.place_of_birth),t.append("date_of_birth",n.date_of_birth),t.append("gender",n.gender),t.append("address",n.address),t.append("boarding_school_name",n.boarding_school_name),t.append("motivation",n.motivation),t.append("province",n.province),t.append("kabupaten",n.kabupaten),t.append("kecamatan",n.kecamatan),t.append("kelurahan",n.kelurahan),t.append("estimated_monthly_income",n.estimated_monthly_income),t.append("number_wa",n.number_wa),n.business_proposal_file&&t.append("business_proposal_file",n.business_proposal_file),n.mustahik_certificate_file&&t.append("mustahik_certificate_file",n.mustahik_certificate_file),n.pesantren_certificate_file&&t.append("pesantren_certificate_file",n.pesantren_certificate_file),J.post(`/user/my-registrations/${s.id}`,{_method:"PATCH",...Object.fromEntries(t)},{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{D("business_proposal_file","mustahik_certificate_file","pesantren_certificate_file")}})},x=a=>t=>{c(a,t.target.files[0])};p.useEffect(()=>{(async()=>{d(t=>({...t,provinces:!0})),u(t=>({...t,provinces:null}));try{const t=await g.get("/api/wilayah/provinces");if(P(t.data),s.province){const l=t.data.find(h=>h.name===s.province);l&&N(l.id)}}catch(t){console.error("Error fetching provinces:",t),u(l=>({...l,provinces:"Gagal memuat data provinsi"})),f.error("Gagal memuat data provinsi")}finally{d(t=>({...t,provinces:!1}))}})()},[]);const N=async a=>{d(t=>({...t,regencies:!0})),u(t=>({...t,regencies:null}));try{const t=await g.get(`/api/wilayah/regencies/${a}`);if(R(t.data),s.kabupaten){const l=t.data.find(h=>h.name===s.kabupaten);l&&w(l.id)}}catch(t){console.error("Error fetching regencies:",t),u(l=>({...l,regencies:"Gagal memuat data kabupaten"})),f.error("Gagal memuat data kabupaten")}finally{d(t=>({...t,regencies:!1}))}},w=async a=>{d(t=>({...t,districts:!0})),u(t=>({...t,districts:null}));try{const t=await g.get(`/api/wilayah/districts/${a}`);if(y(t.data),s.kecamatan){const l=t.data.find(h=>h.name===s.kecamatan);l&&C(l.id)}}catch(t){console.error("Error fetching districts:",t),u(l=>({...l,districts:"Gagal memuat data kecamatan"})),f.error("Gagal memuat data kecamatan")}finally{d(t=>({...t,districts:!1}))}},C=async a=>{d(t=>({...t,villages:!0})),u(t=>({...t,villages:null}));try{const t=await g.get(`/api/wilayah/villages/${a}`);b(t.data)}catch(t){console.error("Error fetching villages:",t),u(l=>({...l,villages:"Gagal memuat data kelurahan"})),f.error("Gagal memuat data kelurahan")}finally{d(t=>({...t,villages:!1}))}},K=k(async a=>{const t=a.target.value,l=a.target.options[a.target.selectedIndex].text;c("province",l),c("kabupaten",""),c("kecamatan",""),c("kelurahan",""),t&&await N(t),y([]),b([])},300),q=k(async a=>{const t=a.target.value,l=a.target.options[a.target.selectedIndex].text;c("kabupaten",l),c("kecamatan",""),c("kelurahan",""),t&&await w(t),b([])},300),B=k(async a=>{const t=a.target.value,l=a.target.options[a.target.selectedIndex].text;c("kecamatan",l),c("kelurahan",""),t&&await C(t)},300),E=a=>{const t=a.target.options[a.target.selectedIndex].text;c("kelurahan",t)};return r(O,{children:[e(j,{title:`Edit Pendaftaran ${s.competition.name}`}),e("div",{className:" bg-gray-50 min-h-screen",children:e("div",{className:"",children:e("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:r("div",{className:"p-8",children:[r("div",{className:"mb-8 text-center",children:[e("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Edit Formulir Pendaftaran"}),e("p",{className:"text-gray-600",children:"Silakan perbarui data berikut sesuai kebutuhan"})]}),r("form",{onSubmit:M,className:"space-y-6",children:[r("div",{className:"space-y-2",children:[r("label",{className:"block text-sm font-medium text-gray-700",children:["Kategori Kompetisi"," ",e("span",{className:"text-red-500",children:"*"})]}),r("select",{name:"category_id",value:n.category_id,onChange:a=>c("category_id",a.target.value),className:`mt-1 block w-full rounded-md border ${i.category_id?"border-red-300":"border-gray-300"} shadow-sm focus:border-[#4CAF50] focus:ring focus:ring-[#4CAF50] focus:ring-opacity-50`,required:!0,children:[e("option",{value:"",children:"-- Pilih Kategori --"}),F.map(a=>e("option",{value:a.id,children:a.name},a.id))]}),i.category_id&&e("p",{className:"mt-1 text-sm text-red-600",children:i.category_id})]}),r("div",{className:"border-t border-gray-200 pt-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informasi Pribadi"}),r("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r("div",{children:[r("label",{className:"block text-sm font-medium text-gray-700",children:["Tempat Lahir"," ",e("span",{className:"text-red-500",children:"*"})]}),e("input",{type:"text",name:"place_of_birth",value:n.place_of_birth,onChange:a=>c("place_of_birth",a.target.value),className:`mt-1 block w-full rounded-md border ${i.place_of_birth?"border-red-300":"border-gray-300"} shadow-sm focus:border-[#4CAF50] focus:ring focus:ring-[#4CAF50] focus:ring-opacity-50`,required:!0}),i.place_of_birth&&e("p",{className:"mt-1 text-sm text-red-600",children:i.place_of_birth})]}),r("div",{children:[r("label",{className:"block text-sm font-medium text-gray-700",children:["Tanggal Lahir"," ",e("span",{className:"text-red-500",children:"*"})]}),e("input",{type:"date",name:"date_of_birth",value:n.date_of_birth,onChange:a=>c("date_of_birth",a.target.value),className:`mt-1 block w-full rounded-md border ${i.date_of_birth?"border-red-300":"border-gray-300"} shadow-sm focus:border-[#4CAF50] focus:ring focus:ring-[#4CAF50] focus:ring-opacity-50`,required:!0}),i.date_of_birth&&e("p",{className:"mt-1 text-sm text-red-600",children:i.date_of_birth})]}),r("div",{children:[r("label",{className:"block text-sm font-medium text-gray-700",children:["Jenis Kelamin"," ",e("span",{className:"text-red-500",children:"*"})]}),r("select",{name:"gender",value:n.gender,onChange:a=>c("gender",a.target.value),className:`mt-1 block w-full rounded-md border ${i.gender?"border-red-300":"border-gray-300"} shadow-sm focus:border-[#4CAF50] focus:ring focus:ring-[#4CAF50] focus:ring-opacity-50`,required:!0,children:[e("option",{value:"",children:"-- Pilih Jenis Kelamin --"}),e("option",{value:"Laki-laki",children:"Laki-laki"}),e("option",{value:"Perempuan",children:"Perempuan"})]}),i.gender&&e("p",{className:"mt-1 text-sm text-red-600",children:i.gender})]}),r("div",{children:[r("label",{className:"block text-sm font-medium text-gray-700",children:["Nomor WhatsApp"," ",e("span",{className:"text-red-500",children:"*"})]}),e("input",{type:"text",name:"number_wa",value:n.number_wa,onChange:a=>c("number_wa",a.target.value),className:`mt-1 block w-full rounded-md border ${i.number_wa?"border-red-300":"border-gray-300"} shadow-sm focus:border-[#4CAF50] focus:ring focus:ring-[#4CAF50] focus:ring-opacity-50`,placeholder:"Contoh: 081234567890",required:!0}),i.number_wa&&e("p",{className:"mt-1 text-sm text-red-600",children:i.number_wa})]})]})]}),r("div",{children:[r("label",{className:"block text-sm font-medium text-gray-700",children:["Alamat Lengkap"," ",e("span",{className:"text-red-500",children:"*"})]}),e("textarea",{name:"address",value:n.address,placeholder:"Contoh : Jl.Rusa 1",onChange:a=>c("address",a.target.value),rows:3,className:`mt-1 block w-full rounded-md border ${i.address?"border-red-300":"border-gray-300"} shadow-sm focus:border-[#4CAF50] focus:ring focus:ring-[#4CAF50] focus:ring-opacity-50`,required:!0}),r("p",{className:"mt-1 text-sm text-gray-500",children:["Isi alamat"," ",e("span",{className:"font-bold",children:"tanpa"})," ","menyertakan RT/RW dan kode pos"]}),i.address&&e("p",{className:"mt-1 text-sm text-red-600",children:i.address})]}),r("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r("div",{children:[r("label",{className:"block text-sm font-medium text-gray-700",children:["Provinsi"," ",e("span",{className:"text-red-500",children:"*"})]}),r("select",{onChange:a=>{a.persist(),K(a)},disabled:o.provinces,className:`mt-1 block w-full rounded-md border ${i.province?"border-red-300":"border-gray-300"} shadow-sm focus:border-[#4CAF50] focus:ring focus:ring-[#4CAF50] focus:ring-opacity-50 ${o.provinces?"opacity-75 cursor-not-allowed":""}`,required:!0,children:[e("option",{value:"",children:"-- Pilih Provinsi --"}),o.provinces?e("option",{value:"",disabled:!0,children:"Memuat provinsi..."}):m.provinces?e("option",{value:"",disabled:!0,className:"text-red-500",children:m.provinces}):A.map(a=>e("option",{value:a.id,selected:a.name===n.province,children:a.name},a.id))]}),i.province&&e("p",{className:"mt-1 text-sm text-red-600",children:i.province})]}),r("div",{children:[r("label",{className:"block text-sm font-medium text-gray-700",children:["Kabupaten/Kota"," ",e("span",{className:"text-red-500",children:"*"})]}),r("select",{onChange:a=>{a.persist(),q(a)},disabled:!n.province||o.regencies,className:`mt-1 block w-full rounded-md border ${i.kabupaten?"border-red-300":"border-gray-300"} shadow-sm focus:border-[#4CAF50] focus:ring focus:ring-[#4CAF50] focus:ring-opacity-50 ${!n.province||o.regencies?"bg-gray-100 opacity-75 cursor-not-allowed":""}`,required:!0,children:[e("option",{value:"",children:"-- Pilih Kabupaten/Kota --"}),o.regencies?e("option",{value:"",disabled:!0,children:"Memuat kabupaten..."}):m.regencies?e("option",{value:"",disabled:!0,className:"text-red-500",children:m.regencies}):$.map(a=>e("option",{value:a.id,selected:a.name===n.kabupaten,children:a.name},a.id))]}),i.kabupaten&&e("p",{className:"mt-1 text-sm text-red-600",children:i.kabupaten})]}),r("div",{children:[r("label",{className:"block text-sm font-medium text-gray-700",children:["Kecamatan"," ",e("span",{className:"text-red-500",children:"*"})]}),r("select",{onChange:a=>{a.persist(),B(a)},disabled:!n.kabupaten||o.districts,className:`mt-1 block w-full rounded-md border ${i.kecamatan?"border-red-300":"border-gray-300"} shadow-sm focus:border-[#4CAF50] focus:ring focus:ring-[#4CAF50] focus:ring-opacity-50 ${!n.kabupaten||o.districts?"bg-gray-100 opacity-75 cursor-not-allowed":""}`,required:!0,children:[e("option",{value:"",children:"-- Pilih Kecamatan --"}),o.districts?e("option",{value:"",disabled:!0,children:"Memuat kecamatan..."}):m.districts?e("option",{value:"",disabled:!0,className:"text-red-500",children:m.districts}):L.map(a=>e("option",{value:a.id,selected:a.name===n.kecamatan,children:a.name},a.id))]}),i.kecamatan&&e("p",{className:"mt-1 text-sm text-red-600",children:i.kecamatan})]}),r("div",{children:[r("label",{className:"block text-sm font-medium text-gray-700",children:["Kelurahan/Desa"," ",e("span",{className:"text-red-500",children:"*"})]}),r("select",{onChange:a=>{a.persist(),E(a)},disabled:!n.kecamatan||o.villages,className:`mt-1 block w-full rounded-md border ${i.kelurahan?"border-red-300":"border-gray-300"} shadow-sm focus:border-[#4CAF50] focus:ring focus:ring-[#4CAF50] focus:ring-opacity-50 ${!n.kecamatan||o.villages?"bg-gray-100 opacity-75 cursor-not-allowed":""}`,required:!0,children:[e("option",{value:"",children:"-- Pilih Kelurahan/Desa --"}),o.villages?e("option",{value:"",disabled:!0,children:"Memuat kelurahan..."}):m.villages?e("option",{value:"",disabled:!0,className:"text-red-500",children:m.villages}):S.map(a=>e("option",{value:a.id,selected:a.name===n.kelurahan,children:a.name},a.id))]}),i.kelurahan&&e("p",{className:"mt-1 text-sm text-red-600",children:i.kelurahan})]})]}),r("div",{className:"border-t border-gray-200 pt-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informasi Pesantren"}),r("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r("div",{children:[r("label",{className:"block text-sm font-medium text-gray-700",children:["Nama Pesantren"," ",e("span",{className:"text-red-500",children:"*"})]}),e("input",{type:"text",name:"boarding_school_name",value:n.boarding_school_name,onChange:a=>c("boarding_school_name",a.target.value),className:`mt-1 block w-full rounded-md border ${i.boarding_school_name?"border-red-300":"border-gray-300"} shadow-sm focus:border-[#4CAF50] focus:ring focus:ring-[#4CAF50] focus:ring-opacity-50`,required:!0}),i.boarding_school_name&&e("p",{className:"mt-1 text-sm text-red-600",children:i.boarding_school_name})]}),r("div",{children:[r("label",{className:"block text-sm font-medium text-gray-700",children:["Perkiraan Penghasilan Bulanan"," ",e("span",{className:"text-red-500",children:"*"})]}),r("select",{name:"estimated_monthly_income",value:n.estimated_monthly_income,onChange:a=>c("estimated_monthly_income",a.target.value),className:`mt-1 block w-full rounded-md border ${i.estimated_monthly_income?"border-red-300":"border-gray-300"} shadow-sm focus:border-[#4CAF50] focus:ring focus:ring-[#4CAF50] focus:ring-opacity-50`,required:!0,children:[e("option",{value:"",children:"-- Pilih Range Penghasilan --"}),e("option",{value:"< Rp 1.000.000",children:"Kurang dari Rp 1.000.000"}),e("option",{value:"Rp 1.000.000 - Rp 3.000.000",children:"Rp 1.000.000 - Rp 3.000.000"}),e("option",{value:"Rp 3.000.000 - Rp 5.000.000",children:"Rp 3.000.000 - Rp 5.000.000"}),e("option",{value:"> Rp 5.000.000",children:"Lebih dari Rp 5.000.000"})]}),i.estimated_monthly_income&&e("p",{className:"mt-1 text-sm text-red-600",children:i.estimated_monthly_income})]})]})]}),r("div",{children:[r("label",{className:"block text-sm font-medium text-gray-700",children:["Motivasi Mengikuti Kompetisi"," ",e("span",{className:"text-red-500",children:"*"})]}),e("textarea",{name:"motivation",value:n.motivation,onChange:a=>c("motivation",a.target.value),rows:4,className:`mt-1 block w-full rounded-md border ${i.motivation?"border-red-300":"border-gray-300"} shadow-sm focus:border-[#4CAF50] focus:ring focus:ring-[#4CAF50] focus:ring-opacity-50`,placeholder:"Jelaskan motivasi Anda mengikuti kompetisi ini (maksimal 500 karakter)",required:!0}),i.motivation&&e("p",{className:"mt-1 text-sm text-red-600",children:i.motivation})]}),r("div",{className:"border-t border-gray-200 pt-6",children:[e("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Upload Dokumen"}),e("p",{className:"text-sm text-gray-500 mb-6",children:"Silakan upload dokumen baru jika ingin mengubah (format PDF, maksimal 2MB per file)"}),r("div",{className:"space-y-6",children:[r("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Proposal Bisnis"}),r("p",{className:"text-sm text-[#4CAF50] mb-2",children:["File saat ini:"," ",e("a",{href:s.business_proposal_file_url,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"Lihat Dokumen"})]}),e("div",{className:"mt-1 flex items-center",children:r("label",{className:"flex flex-col items-center px-4 py-6 bg-white rounded-lg border border-dashed border-gray-300 cursor-pointer hover:bg-gray-50 transition-colors duration-150",children:[e("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e("span",{className:"mt-2 text-sm text-gray-600",children:n.business_proposal_file?n.business_proposal_file.name:"Pilih File Baru (Opsional)"}),e("input",{type:"file",name:"business_proposal_file",onChange:x("business_proposal_file"),className:"hidden",accept:".pdf"})]})}),i.business_proposal_file&&e("p",{className:"mt-1 text-sm text-red-600",children:i.business_proposal_file}),v&&r("progress",{value:v.percentage,max:"100",className:"w-full mt-2 h-1 rounded bg-gray-200 [&::-webkit-progress-bar]:rounded [&::-webkit-progress-value]:rounded [&::-webkit-progress-value]:bg-[#4CAF50]",children:[v.percentage,"%"]})]}),r("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Sertifikat Mustahik"}),r("p",{className:"text-sm text-[#4CAF50] mb-2",children:["File saat ini:"," ",e("a",{href:s.mustahik_certificate_file_url,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"Lihat Dokumen"})]}),e("div",{className:"mt-1 flex items-center",children:r("label",{className:"flex flex-col items-center px-4 py-6 bg-white rounded-lg border border-dashed border-gray-300 cursor-pointer hover:bg-gray-50 transition-colors duration-150",children:[e("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e("span",{className:"mt-2 text-sm text-gray-600",children:n.mustahik_certificate_file?n.mustahik_certificate_file.name:"Pilih File Baru (Opsional)"}),e("input",{type:"file",name:"mustahik_certificate_file",onChange:x("mustahik_certificate_file"),className:"hidden",accept:".pdf"})]})}),i.mustahik_certificate_file&&e("p",{className:"mt-1 text-sm text-red-600",children:i.mustahik_certificate_file})]}),r("div",{children:[e("label",{className:"block text-sm font-medium text-gray-700",children:"Sertifikat Pesantren"}),r("p",{className:"text-sm text-[#4CAF50] mb-2",children:["File saat ini:"," ",e("a",{href:s.pesantren_certificate_file_url,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:"Lihat Dokumen"})]}),e("div",{className:"mt-1 flex items-center",children:r("label",{className:"flex flex-col items-center px-4 py-6 bg-white rounded-lg border border-dashed border-gray-300 cursor-pointer hover:bg-gray-50 transition-colors duration-150",children:[e("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e("span",{className:"mt-2 text-sm text-gray-600",children:n.pesantren_certificate_file?n.pesantren_certificate_file.name:"Pilih File Baru (Opsional)"}),e("input",{type:"file",name:"pesantren_certificate_file",onChange:x("pesantren_certificate_file"),className:"hidden",accept:".pdf"})]})}),i.pesantren_certificate_file&&e("p",{className:"mt-1 text-sm text-red-600",children:i.pesantren_certificate_file})]})]})]}),r("div",{className:"flex justify-end pt-6 border-t border-gray-200 space-x-4",children:[e(G,{href:route("user.registrations.index"),className:"inline-flex items-center px-6 py-3 border border-gray-300 shadow-sm text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#4CAF50] transition-colors duration-200",children:"Batal"}),e("button",{type:"submit",disabled:_,className:`inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-[#4CAF50] hover:bg-[#259148] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#4CAF50] transition-colors duration-200 ${_?"opacity-75 cursor-not-allowed":""}`,children:_?r(W,{children:[r("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Memproses..."]}):"Simpan Perubahan"})]})]})]})})})})]})}export{Z as default};
